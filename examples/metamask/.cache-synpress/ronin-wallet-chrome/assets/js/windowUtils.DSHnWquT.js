import{b as o,L as u,M as E,i as m}from"./foregroundCache.BJs-C-d6.js";var D=(e=>(e.Local="local",e.Sync="sync",e.Managed="managed",e.Session="session",e))(D||{});async function M(e,t){function n(s){return typeof s=="function"}function a(s){return s instanceof Promise}return n(e)?a(e)?await e(t):e(t):e}let C=!1;function g(e){if(o.storage[e]===void 0)throw new Error(`Check your storage permission in manifest.json: ${e} is not defined`)}function G(e,t,n){let a=null,s=[];const c=(n==null?void 0:n.storageType)??"local";C===!1&&c==="session"&&(n==null?void 0:n.sessionAccessForContentScripts)===!0&&(g(c),o.storage[c].setAccessLevel({accessLevel:"TRUSTED_AND_UNTRUSTED_CONTEXTS"}),C=!0);const l=async()=>(g(c),(await o.storage[c].get([e]))[e]??t);o.runtime.onMessage.addListener((r,i)=>{if(i.id!==o.runtime.id)return u.error(`Receiving message from unauthorized sender ${i}`),Promise.reject(`Receiving message from unauthorized sender ${i}`);if(r.type===E.STORAGE_CHANGE&&r.storageKey===e)return l().then(f=>{a=f,N()}),Promise.resolve(!0)});const N=()=>{s.forEach(r=>r())},p=async r=>{a=await M(r,a),await o.storage[c].set({[e]:a}),N()},d=r=>{s=[...s,r]},h=r=>(s=s.filter(i=>i!==r),s),w=()=>(s=[],s),y=()=>a;return l().then(r=>{a=r,N()}),{get:l,set:p,getSnapshot:y,subscribe:d,unSubscribe:h,unSubscribeAll:w,migration:async(r,i)=>{}}}var k=(e=>(e.CONFIG_STORE="configs-storage-key",e.ACTION_QUEUE_STORE="action-queue-key",e.SESSION_STORE="session-storage-key",e.SETTING_STORE="lock-storage-setting",e.TRACKING_STORE="tracking-storage-key",e.ACCOUNT_STORE="app-account-storage-key",e.PASSCODE_STORE="passcode-storage-key",e.WALLET_STORE="wallet-storage-key",e.TX_STORE="tx-store-key",e.UNLOCK_STORE="unlock-store-key",e.TEMP_STORE="temp-store-key",e.APP_SESSION_STORE="app-session-store-key",e.ONE_TIME_STORE="one-time-store",e))(k||{}),v=(e=>(e.SELECT_TOKEN="select-token",e.SELECT_RECIPIENT="select-recipient",e.ENTER_AMOUNT="enter-amount",e.CONFIRM="confirm",e))(v||{}),b=(e=>(e.SELECT_TOKEN="select-token",e.BUY_TOKEN="buy-token",e))(b||{}),I=(e=>(e.HOME="/",e.ACTIVITY="/activity",e.SETTINGS="/settings",e.SETTING_SECURITY="/settings/security",e.SETTINGS_PREFERENCE="/settings/preference",e.SETTINGS_CONNECTED_APPS="/settings/connected-dapps",e.UNLOCK="/unlock",e.MANAGE_WALLET="/manage-wallet",e.COLLECTION="/nft/collection",e.ERC20_DETAIL="/erc20",e.TRANSFER_NFT_BASE="/transfer-nft",e.TRANSFER_ERC20_BASE="/transfer-erc20",e.ADDRESS="/address",e.WELCOME="/welcome",e.LOADING="/loading",e.SESSION_CONNECT="/session-connect",e.CREATE_NEW_WALLET="/create-new-wallet",e.CONFIRM_RESET="/confirm-reset",e.REVEAL_RECOVERY_SEEDPHRASE="/reveal-recovery-seedphrase",e.REVEAL_PRIVATE_KEY="/reveal-private-key",e.REVEAL_RECOVERY_PASSWORD="/reveal-recovery-password",e.UPGRADE_NOW="/upgrade-now",e.DEPOSIT="/deposit",e.FORGOT_PASSWORD="/forgot-password",e.ON_RAMP="/on-ramp",e.CONNECT_SIGN="/sign-connect",e.CONNECT_ADDRESS="/address-connect",e.SWITCH_CHAIN="/switch-chain",e.TX_SIGN="/sign-tx",e.CHANGE_PASSWORD="/change-password",e.CUSTOM_GAS="/custom-gas",e.ACCOUNT_NOT_CONNECTED="/account-not-connected",e.CHANGE_PASSCODE="/change-passcode",e.MANAGE_TOKEN="/manage-token",e.MANAGE_NFT="/manage-nft",e.ADD_CUSTOM_TOKEN="/add-custom-token",e.ADD_CUSTOM_NFT="/add-custom-nft",e.CUSTOM_RPC="/custom-rpc",e.ADD_CUSTOM_RPC="/custom-rpc/add",e.EDIT_CUSTOM_RPC="/custom-rpc/edit",e.RONIN_BOUNTIES="/ronin-bounties",e.QUEST_DETAILS="/quest-details",e.MY_QUEST="/my-quest",e.MY_REWARD="/my-reward",e))(I||{}),S=(e=>(e.WELCOME="/",e.CREATE_SEEDPHRASE="/create-seedphrase",e.WALLET_OPTIONS="/wallet-options",e.CREATE_SOCIAL="/create-social",e.IMPORT_WALLET="/import-wallet",e.IMPORT_SOCIAL="/import-social",e.IMPORT_VIEW_ONLY="/import-view-only",e.IMPORT_KEY="/import-key",e.AUTHENTICATION="/authentication",e.MIGRATION="/migration",e.HARDWARE="/hardware",e.FINISH="/finish",e.REAUTHENTICATION="/reauthentication",e.UNLOCK="/unlock",e.VERIFY_SOCIAL="/verify-social",e.RECONNECT_LEDGER="/reconnect-ledger",e.TRACKING_CONSENT="/tracking-consent",e))(S||{}),W=(e=>(e.Action="action",e))(W||{});function O(e,t){return chrome.runtime.getURL(`src/pages/newtab/new-tab.html?#${e}/${t||""}`)}function L(e,t){return chrome.runtime.getURL(`src/pages/popup/popup.html?#${e}/${t||""}`)}const $=async()=>{const e=await o.windows.getCurrent();return{tab:(await o.tabs.query({active:!0,highlighted:!0,currentWindow:!0})).find(n=>n.windowId===(e==null?void 0:e.id)),window:e}},B=e=>{let t="";try{e!=null&&e.url&&(t=new URL(e.url).hostname)}catch(n){u.error("getTabHostname",e.url,n),t=e.url}return t},Q=async()=>{const e=chrome.runtime.getURL("src/pages/sidepanel/request-open/index.html*");return await chrome.tabs.query({url:e})},X=async()=>{const e=chrome.runtime.getURL("src/pages/popup/popup.html*");return await chrome.tabs.query({url:e})},V=()=>{const e=L(I.HOME);try{return new URL(e).hostname}catch(t){return u.error("getFirefoxInternalId",t),""}},j=()=>m()?V():o.runtime.id,z=e=>{try{return m()?o.tabs.create({url:e}):window.open(e,"_blank")}catch(t){u.error("openUrl",t)}};export{S as F,b as O,W as Q,I as R,k as S,v as T,O as a,$ as b,B as c,G as d,D as e,Q as f,j as g,X as h,z as o};
