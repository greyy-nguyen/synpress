var P=Object.defineProperty;var S=(t,e,s)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var c=(t,e,s)=>(S(t,typeof e!="symbol"?e+"":e,s),s);import{L as l,b as d,i as g}from"./foregroundCache.BJs-C-d6.js";import{d as f,e as O,S as m,h as y,f as _}from"./windowUtils.DSHnWquT.js";class b{constructor(){c(this,"_isSidePanel",!1);c(this,"_isOpening",!1)}get isSidePanel(){return this._isSidePanel}set isSidePanel(e){this._isSidePanel=e}get isOpening(){return this._isOpening}set isOpening(e){this._isOpening=e}}const w=new b,u=f(m.APP_SESSION_STORE,{isOpening:!1},{storageType:O.Session}),T={...u,setIsOpening:t=>u.set(e=>({...e,isOpening:t}))},h=async(t=!0,e)=>{const s=await d.windows.getCurrent({populate:!0}),{isOpening:n}=await T.get();if(n){const r=await y();if(!(!w.isSidePanel&&r.length===0))return}const o=s.left+s.width-375-20,a=s.top+100,i=g()?"detached_panel":"popup",p=`src/pages/popup/popup.html${t?"?closeOnComplete=true":""}`;await d.windows.create({url:p,focused:!0,width:375,height:600,type:i,left:o,top:a,...e})},C=async t=>{g()?d.sidebarAction.toggle():await chrome.sidePanel.open({tabId:t})},R=async t=>{try{const s=(await _())[0];if(!(s!=null&&s.id)){const n=await chrome.windows.getCurrent(),o=320,a=375,i=Math.round((n.top??0)+((n.height??o)-o)/2),p=Math.round((n.left??0)+((n.width??a)-a)/2),r="src/pages/sidepanel/request-open/index.html?tabId="+t;await h(!0,{width:a,height:o,top:i,left:p,url:r});return}await chrome.windows.update(s.windowId,{focused:!0})}catch(e){l.error("openRequestSidePanelPopup",e)}},q=async(t,e=!0,s)=>{try{s?C(t).catch(()=>{R(t)}):await h(e)}catch(n){l.error("openWallet",n)}},I=async(t,e=!0)=>{await q(t,e,w.isSidePanel)};export{T as a,w as b,q as c,C as d,I as o};
